version: 1
applications:
  - backend:
      phases:
        build:
          commands:
            - pip install --upgrade pip
            - pip install -r requirements.txt
            - echo "PORT=8000" >> .env
            - echo "FLASK_APP=run.py" >> .env
            - echo "FLASK_ENV=production" >> .env
        post_build:
          commands:
            - echo "Build completed successfully"
      start:
        command: gunicorn --worker-class eventlet -w 1 --bind 0.0.0.0:8000 --timeout 120 wsgi:wsgi
      artifacts:
        baseDirectory: .
        files:
          - '**/*'
      cache:
        paths:
          - '/root/.cache/pip/**/*'
    frontend:
      phases:
        build:
          commands:
            - echo "No frontend build required"
      artifacts:
        baseDirectory: .
        files:
          - '**/*'
    appRoot: .
    buildSpec:
      timeoutInMinutes: 10